var checkform_message=[];checkform_message.fr="Les champs suivants sont incorrects : ";checkform_message.en="The following fields are invalid : ";checkform_message.sp="Los siguientes campos son incorrectas : ";checkform_message.ge="Die folgenden Felder sind nicht korrekt : ";function jqchf_getDefaultOptions(){return{type:"text",event:"submit",autoCheck:true,language:"en",CSSClass:"checkform-wrong",target:null,ajaxURL:null,ajaxEvent:null,afterValidate:function(){return true},beforeValidate:function(){return true},afterItemValidate:function(a){return true},beforeItemValidate:function(a){return true}}}function jqchf_getDefaultItems(){return{mail:{selector:"[name=email]",pattern:"^[a-z0-9][a-z0-9._-]*@([a-z0-9._-]+[._-]?[a-z0-9]+)+.[a-z]{2,4}$",autoTrim:true,ajaxCheck:false},name:{selector:"[name=name]",pattern:"^([a-zA-Zéèëïêàâùçîû][ '-]?)+[a-zA-Zéèëïêàâùçîû]+$",autoTrim:true,ajaxCheck:false},firstname:{selector:"[name=firstname]",pattern:"^([a-zA-Zéèëïêàâùçîû][ '-]?)+[a-za-zA-Zéèëïêàâùçîû]+$",autoTrim:true,ajaxCheck:false},pseudo:{selector:"[name=pseudo]",pattern:"^[a-zA-Zéèëïêàâùçîû0-9][a-zA-Zéèëïêàâùçîû0-9_ -]{0,13}[a-zA-Zéèëïêàâùçîû0-9]$",autoTrim:true,ajaxCheck:false},password:{selector:"[name=password]",pattern:"^.{4,25}$",autoTrim:false,ajaxCheck:false},birthday:{selector:"[name=birthday]",pattern:"^[0-9]{2}/[0-9]{2}/[0-9]{4}$",autoTrim:true,ajaxCheck:false},phonenumber:{selector:"[name=phonenumber]",pattern:"^0[1-9]([-. ]?[0-9]{2}){4}$",autoTrim:true,ajaxCheck:false},website:{selector:"[name=website]",pattern:"^[a-zA-Z0-9-.]+.(com|org|net|mil|edu|COM|ORG|NET|MIL|EDU)$",autoTrim:true,ajaxCheck:false}}}function jqchf_getTemplateNewItem(){return{autoTrim:true,ajaxCheck:false}}(function(e){var a=jqchf_getDefaultOptions();var c={type:["text","label","flash","input"],event:["submit","change","lostfocus"],autoCheck:[true,false],language:["en","fr","sp","ge"],CSSClass:null,target:null,ajaxURL:null,ajaxEvent:["submit","lostfocus","change"],};var b={init:function(r){var h=[];h.lostfocus="focusout";h.change="keyup";var f=e(this);var o=jqchf_getDefaultItems();var l=jqchf_getDefaultOptions();var p={};e.extend(p,l,r);if(e.inArray(p.event,c.event)===-1){e.error("Jquery checkform : value "+p.items+" not allowed for event")}if(e.inArray(p.type,c.type)===-1){e.error("Jquery checkform : value "+p.items+" not allowed for type")}if(e.inArray(p.autoCheck,c.autoCheck)===-1){e.error("Jquery checkform : value "+p.items+" not allowed for autoCheck")}if(typeof p.afterValidate!=="function"){e.error("Jquery checkform : value "+p.items+" not allowed for afterValidate")}if(typeof p.beforeValidate!=="function"){e.error("Jquery checkform : value "+p.items+" not allowed for beforeValidate")}if(typeof p.afterItemValidate!=="function"){e.error("Jquery checkform : value "+p.items+" not allowed for afterItemValidate")}if(typeof p.beforeItemValidate!=="function"){e.error("Jquery checkform : value "+p.items+" not allowed for beforeItemValidate")}if(p.items===undefined){}var q;if(p.autoCheck===true){e.extend(true,o,p.items);q=o}else{q=p.items}var g='input[type="text"],input[type="password"],textarea';var n=f.find(g);g="";for(var k in q){g+=q[k].selector+",";if(d[k]===undefined){if(q[k].selector===undefined||q[k].pattern===undefined){e.error("Jquery checkform : you must precise pattern and selector for item "+k)}var j=new Object();e.extend(j,jqchf_getTemplateNewItem(),q[k]);q[k]=j}else{if(p.autoCheck===false){e.extend(q[k],o[k])}}if(q[k].ajaxCheck){n.filter(q[k].selector).data("jqchf-ajax-ok",false)}n.filter(q[k].selector).data("jqchf-reg",q[k].pattern).data("jqchf-role",k).data("jqchf-trim",q[k].autoTrim).data("jqchf-ajax",q[k].ajaxCheck).addClass("jqchf-flag")}g=g.substr(0,g.length-1);var m=f.find(g);if(h[p.event]){m.on(h[p.event],function(i){f.data("jqchf-form-opt").beforeItemValidate(e(this));f.checkform("validate",e(this));if(e(this).data("jqchf-ok")===true){f.data("jqchf-form-opt").afterItemValidate(e(this))}})}if(h[p.ajaxEvent]){m.filter(function(){return e(this).data("jqchf-ajax")===true}).on(h[p.ajaxEvent],function(i){f.checkform("validateAjax",e(this))})}delete p.items;f.data("jqchf-form-opt",p);f.on("submit",function(){f.data("jqchf-form-opt").beforeValidate();if(f.data("jqchf-form-opt").ajaxURL!==null){e(this).checkform("validateAjax")}e(this).checkform("validate");var i=f.data("jqchf-form-ok");if(f.data("jqchf-form-opt").ajaxURL){i=i&&f.data("jqchf-form-ajax-ok")}if(i!==false){return f.data("jqchf-form-opt").afterValidate()}return false})},check:function(h){if(h){var j=e(this);var g=e(h);var k=g.data("jqchf-reg");var i=new RegExp(k);if(g.data("jqchf-trim")===true){g.val(g.val().trim());g.data("jqchf-ok",i.test(g.val()))}else{g.data("jqchf-ok",i.test(g.val()))}var f=j.find(".jqchf-flag");var l=f.filter(function(){return e(this).data("jqchf-ok")===false});if(l.size()===0){j.data("jqchf-form-ok",true)}else{j.data("jqchf-form-ok",false)}}else{var j=e(this);var f=j.find(".jqchf-flag");f.each(function(){j.checkform("check",e(this))})}},validate:function(f){var g=e(this);if(f){f=e(f);g.checkform("check",f);g.checkform("uiAction",f)}else{g.checkform("check");g.checkform("uiAction")}},uiAction:function(h){var i=e(this);if(h){h=e(h);var r=i.data("jqchf-form-opt").type;var g=i.data("jqchf-form-ok")===false||i.data("jqchf-form-ajax-ok")===false;var t=h.data("jqchf-ok")===false||(h.data("jqchf-ajax-ok")!==undefined&&h.data("jqchf-ajax-ok")===false);var o=i.data("jqchf-form-opt").CSSClass;var y="";switch(r){case"flash":var w=o.replace(/\s/g,".");y='<a href="#" title="Close flash">X</a>';i.on("click","a",function(A){e(this).parentsUntil("form").filter("div."+w).remove();A.preventDefault()});case"text":var j=h.attr("name");var f=h.prev("label");var w=o.replace(/\s/g,".");var l="lbl-err-"+j;var q="label."+l;var n=i.find("div."+w);if(t&&n.size()===0){var z=i.data("jqchf-form-opt").language;i.append('<div class="'+o+'">'+checkform_message[z]+"</div>");n=i.find("div."+w).prepend(y)}if(t){if(n.find(q).size()===0){var m="";if(h.attr("id")!==undefined){m='for="'+h.attr("id")+'"'}var x=n.children(":last-child");x.text(x.text().replace(".",","));n.append("<label "+m+' class="'+l+'">'+f.text()+",</label>")}}else{n.children(q).remove();if(!g){i.find("div."+w).remove()}}x=n.children(":last-child");x.text(x.text().replace(",","."));break;case"label":h=h.prev("label");case"input":if(t){h.addClass(o)}else{h.removeClass(o)}break;default:}var k=h.data("jqchf-ajax");if(k){var p=h.data("jqchf-ajax-ok");var u=h.next("span.ajax."+o);if(u.size()===0&&!p){var v=e("<span></span>").text(h.data("jqchf-ajax-msg")).addClass("ajax "+o);h.after(v)}else{if(p){u.remove()}}}}else{var i=e(this);var s=i.find(".jqchf-flag");s.each(function(){i.checkform("uiAction",e(this))})}},destroy:function(){var f=e(this);f.find(".jqchf-flag").each(function(){e(this).removeData("jqchf-reg").removeData("jqchf-trim").removeData("jqchf-role");var g=f.data("jqchf-form-opt").event;if(g==="change"||g==="lostfocus"){e(this).off(g)}}).removeData("jqchf-form-opt").removeData("jqchf-form-ok").removeClass("jqchf-flag");f.off("submit")},validateAjax:function(g){var h=e(this);var f=g!==undefined;var i=new Object();if(f){g=e(g);i[g.attr("name")]=g.val()}else{h.find(".jqchf-flag").filter(function(){return e(this).data("jqchf-ajax")===true}).each(function(){i[e(this).attr("name")]=e(this).val()})}e.ajax({url:h.data("jqchf-form-opt").ajaxURL,dataType:"json",type:"POST",crossDomain:true,async:f,data:i}).success(function(l){var k=l.items;var n=l.status==="OK"?true:false;for(var m in k){var j=k[m].status==="OK"?true:false;h.find("[name="+m+"]").data("jqchf-ajax-ok",j).data("jqchf-ajax-msg",k[m].message)}if(!f){h.data("jqchf-form-ajax-ok",n);h.checkform("uiAction")}else{h.checkform("uiAction",g)}}).error(function(j){console.log(j)})}};var d=jqchf_getDefaultItems();jQuery.fn.checkform=function(f,g){this.each(function(){if(this.tagName.toLowerCase()!=="form"){e.error("Jquery checkform : tag "+this.tagName+" not allowed")}if(b[f]){return b[f].apply(this,g)}else{if(typeof f==="object"||!f){return b.init.apply(this,[f])}else{e.error("Method "+f+" does not exist on jQuery.checkform")}}});return this}})(jQuery);